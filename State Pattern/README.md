题目无关：长时间加班，没加班费，士气更加低落，效率持续低落，赶进度更加不会保证质量。

# 状态模式

上午状态良好，中午想睡觉，下午慢慢恢复，晚上加班苦苦煎熬，不同的时间有不同的状态。第一版代码：

```cpp
class work {
if (hour < 12)
    cout << 还行
else if (hour < 13)
    cout << 困
else if (hour < 17)
    cout << 恢复
else if (hour < 22)
    cout << 煎熬
};
```

---

**方法过长不是好事**，且其中有很多糟糕的分支判断，如果提前完成任务，22 点对应的状态应该是下班，老板要求 20 点之前必须离开公司，任何需求的改动或者增加，状态改变都需要修改这里。面向对象的设计希望程序可以分解，上述程序违背了**单一职责原则，开放-封闭原则**。

应该：把分支变成一个类，增加或修改不会影响其它类，状态的变化在各自类中完成。引出状态模式：一个对象的内在状态改变时允许改变行为。主要解决控制一个对象状态（hour）转换的条件表达式（一堆 if else）过于复杂的情况，把状态的判断逻辑转移到表示不同状态的一系列类中，可以把复杂的逻辑判断简化。

1. 将与特定状态相关的行为局部化，将不同的行为分割开
2. 特定状态相关的行为放入一个对象中，所有状态相关的代码位于某个文件，所以可以通过定义子类增加新的状态和转换
3. 消除庞大的分支语句，大的分支难以修改和维护，任何改动都是致命的
4. 状态模式把各种各样的逻辑转换分布到子类中，减少相互依赖

## 应用场景

当一个对象的行为取决于状态，并且运行期间，时刻根据状态改变行为，可以考虑状态模式。

如果某项业务有多个状态，通常是一些枚举量，状态的变化都是依赖大量的分支判断，此时可以为每一种业务状态定义一个子类。对象可以不依赖其它对象而独立变化，用户更改需求，增加或减少业务状态与流程，都会很简单。

