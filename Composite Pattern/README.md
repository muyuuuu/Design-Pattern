# 组合模式

假设一家公司，北京总部，南京、杭州有分公司，想使用一套人员管理代码。因为公司的组成是树形结构，不是平行的，所以，得根据 ID 一个一个判断是总部还是分公司，再去执行相关方法。

其它类似情况：word 中，能对个别字加粗，也能对整段加粗。即：整体与部分可以被一致对待。整体是树的根，子公司是分支上的树叶，尽管叶子不同，但差别也不会很大。

组合模式：将对象组合成树形结构，表示『部分-整体』的层次结构，使得用户对单个对象和组合对象的使用具有一致性。

---

树有无数的分支，反复用 `composite` 添加或删除节点，实现树状结构。

- 透明方式，component 中声明了子类的方法，包括删除和添加，所以 component 的子类也包含了这些方法。好处是叶子节点和外界节点没有区别，具有完全一致的接口。但叶子节点本身不需要具备添加和删除的方法，所以不用实现。
- 安全方式，component 中不声明添加和删除，叶子子类也不需要实现。但分支的子类 composite 需要实现添加和删除方法。由于不够透明，树枝和树叶具备不同的接口，客户端调用需要做出判断。

---

- `company.h`，虚基类，根节点或叶子节点都需要继承自这里
- `department.h`，叶子节点，具体部门
- `composite.h`，分支节点，用于添加部门和调用部门功能
- `main.cpp`，编译运行

---

## 使用场景与优势

- 需求中体现了部分与整体层次的结构，希望用户可以忽略组合对象与单个对象的不同，统一使用组合结构中的所有对象
- 基本对象可以组合成复杂的组合对象，不断递归。任何使用基本对象的场景都可以使用组合对象
- 用户不关心处理一个叶节点还是处理一个组合组件，不用写一些判断语句来判断是叶子还是根
- 让客户一致的使用组合结构和单个对象